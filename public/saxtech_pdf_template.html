<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <style>
        @page {
            size: A4;
            margin: 0;
        }
        
        body {
            font-family: 'Segoe UI', 'Arial', sans-serif;
            margin: 0;
            padding: 0;
            color: #2c3e50;
            line-height: 1.5;
            font-size: 13px;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }
        
        /* Cover Page */
        .cover-page {
            height: 100vh;
            background: linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 50%, #404040 100%);
            color: white;
            display: flex;
            flex-direction: column;
            position: relative;
            page-break-after: always;
            box-shadow: inset 0 0 100px rgba(0,0,0,0.3);
        }
        
        .cover-header {
            padding: 45px 50px 25px 50px;
            font-size: 11px;
            line-height: 1.7;
            font-weight: 300;
            letter-spacing: 0.5px;
        }
        
        .sax-logo {
            position: absolute;
            top: 280px;
            right: 60px;
            text-align: center;
            filter: drop-shadow(3px 3px 6px rgba(0,0,0,0.4));
        }
        
        .sax-logo .main-logo {
            font-size: 120px;
            font-weight: 900;
            color: white;
            letter-spacing: -8px;
            line-height: 0.8;
            text-shadow: 2px 2px 8px rgba(0,0,0,0.5);
        }
        
        .sax-logo .yellow {
            color: #F1C40F;
            filter: drop-shadow(2px 2px 4px rgba(241,196,15,0.3));
        }
        
        .sax-logo .tagline {
            color: #F1C40F;
            font-size: 24px;
            margin-top: 15px;
            font-weight: 300;
            letter-spacing: 3px;
            text-shadow: 1px 1px 3px rgba(0,0,0,0.5);
        }
        
        .client-name {
            font-size: 64px;
            font-weight: 900;
            text-transform: uppercase;
            margin: 180px 0 0 50px;
            line-height: 0.85;
            letter-spacing: -2px;
            text-shadow: 3px 3px 10px rgba(0,0,0,0.7);
            background: linear-gradient(45deg, #ffffff 0%, #e8e8e8 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .cover-footer {
            padding: 45px 50px;
            margin-top: auto;
            margin-bottom: 120px;
            background: rgba(0,0,0,0.2);
            border-radius: 15px 0 0 0;
            backdrop-filter: blur(10px);
        }
        
        .cover-footer h3 {
            color: #F1C40F;
            margin-bottom: 10px;
            font-size: 14px;
            font-weight: 600;
            letter-spacing: 1.5px;
            text-transform: uppercase;
        }
        
        .cover-footer div {
            margin-bottom: 25px;
            line-height: 1.5;
            font-weight: 300;
        }
        
        .wave-decoration {
            display: none;
        }
        
        /* Executive Summary Page */
        .exec-summary-page {
            height: 100vh;
            display: flex;
            flex-direction: column;
            page-break-after: always;
            background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%);
        }
        
        .page-header {
            background: linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 50%, #404040 100%);
            color: white;
            padding: 45px 50px;
            position: relative;
            height: 100px;
            display: flex;
            align-items: center;
            box-shadow: 0 5px 20px rgba(0,0,0,0.3);
        }
        
        .page-header h1 {
            font-size: 48px;
            margin: 0;
            text-transform: uppercase;
            font-weight: 900;
            letter-spacing: -1px;
            text-shadow: 2px 2px 6px rgba(0,0,0,0.5);
        }
        
        .yellow-arrow {
            position: absolute;
            right: 0;
            top: 0;
            bottom: 0;
            width: 100px;
            background: linear-gradient(45deg, #F1C40F 0%, #F39C12 100%);
            clip-path: polygon(0 0, 70% 0, 100% 50%, 70% 100%, 0 100%, 30% 50%);
            box-shadow: -3px 0 10px rgba(241,196,15,0.3);
        }
        
        .page-content {
            padding: 45px 50px;
            flex: 1;
            font-size: 13px;
            line-height: 1.7;
            background: white;
            border-radius: 0 0 20px 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .client-info {
            margin-bottom: 35px;
            line-height: 1.5;
            color: #34495e;
            font-weight: 400;
        }
        
        .date-right {
            float: right;
            margin-top: -85px;
            font-weight: 500;
            color: #7f8c8d;
        }
        
        .letter-content {
            text-align: justify;
            line-height: 1.7;
            color: #2c3e50;
        }
        
        .letter-content p {
            margin-bottom: 18px;
        }
        
        .signature {
            margin-top: 50px;
            line-height: 1.5;
            font-weight: 500;
            color: #34495e;
        }
        
        /* SAX Added Value Page */
        .sax-value-page {
            height: 100vh;
            display: flex;
            flex-direction: column;
            page-break-after: always;
            background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%);
        }
        
        .value-content {
            padding: 45px 50px;
            flex: 1;
            background: white;
            border-radius: 0 0 20px 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .value-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 35px;
            margin-top: 35px;
        }
        
        .value-item {
            margin-bottom: 30px;
            padding: 25px;
            background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%);
            border-radius: 12px;
            border-left: 4px solid #F1C40F;
            box-shadow: 0 3px 15px rgba(0,0,0,0.08);
            transition: all 0.3s ease;
        }
        
        .value-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(0,0,0,0.12);
        }
        
        .value-item h3 {
            color: #2c3e50;
            font-size: 15px;
            text-transform: uppercase;
            font-weight: 700;
            margin-bottom: 12px;
            letter-spacing: 1px;
        }
        
        .value-item p {
            line-height: 1.6;
            font-size: 12px;
            text-align: justify;
            color: #34495e;
            margin: 0;
        }
        
        /* SOW Pages */
        .sow-page {
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            page-break-before: always;
            background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%);
        }
        
        .section-content {
            padding: 45px 50px;
            flex: 1;
            background: white;
            border-radius: 0 0 20px 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .section-content h2 {
            color: #2c3e50;
            font-size: 19px;
            margin-bottom: 18px;
            font-weight: 700;
            border-bottom: 2px solid #F1C40F;
            padding-bottom: 8px;
        }
        
        .section-content h3 {
            color: #34495e;
            font-size: 15px;
            margin: 25px 0 12px 0;
            font-weight: 600;
            position: relative;
            padding-left: 15px;
        }
        
        .section-content h3:before {
            content: '';
            position: absolute;
            left: 0;
            top: 50%;
            transform: translateY(-50%);
            width: 4px;
            height: 20px;
            background: linear-gradient(45deg, #F1C40F 0%, #F39C12 100%);
            border-radius: 2px;
        }
        
        .section-content p {
            margin: 12px 0;
            line-height: 1.7;
            text-align: justify;
            color: #2c3e50;
        }
        
        .section-content ul {
            margin: 12px 0;
            padding-left: 25px;
        }
        
        .section-content li {
            margin-bottom: 10px;
            line-height: 1.6;
            color: #34495e;
            position: relative;
        }
        
        .section-content li:before {
            content: '';
            position: absolute;
            left: -15px;
            top: 8px;
            width: 6px;
            height: 6px;
            background: #F1C40F;
            border-radius: 50%;
        }
        
        .commercials-section {
            margin-top: 35px;
        }
        
        .commercials-section h2 {
            color: #2c3e50;
            font-size: 19px;
            margin-bottom: 18px;
            font-weight: 700;
            border-bottom: 2px solid #F1C40F;
            padding-bottom: 8px;
        }
        
        .commercials-section h3 {
            color: #34495e;
            font-size: 15px;
            margin: 25px 0 12px 0;
            font-weight: 600;
            position: relative;
            padding-left: 15px;
        }
        
        .commercials-section h3:before {
            content: '';
            position: absolute;
            left: 0;
            top: 50%;
            transform: translateY(-50%);
            width: 4px;
            height: 20px;
            background: linear-gradient(45deg, #F1C40F 0%, #F39C12 100%);
            border-radius: 2px;
        }
        
        .pricing-box {
            background: white;
            border: 1px solid #dee2e6;
            padding: 20px;
            margin: 15px 0;
            border-radius: 8px;
            box-shadow: none;
        }
        
        .pricing-box ul {
            margin: 0;
            padding: 0;
            list-style: none;
        }
        
        .pricing-box li {
            margin-bottom: 8px;
            line-height: 1.6;
            color: #2c3e50;
            position: relative;
            padding-left: 15px;
        }
        
        .pricing-box li:before {
            content: '';
            position: absolute;
            left: 0;
            top: 8px;
            width: 6px;
            height: 6px;
            background: #F1C40F;
            border-radius: 50%;
        }
        
        /* Investment Summary Page */
        .investment-page {
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            page-break-before: always;
            page-break-inside: avoid;
            background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%);
        }
        
        .investment-content {
            padding: 45px 50px;
            flex: 1;
            background: white;
            border-radius: 0 0 20px 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .transition-section {
            margin-bottom: 35px;
        }
        
        .transition-section h2 {
            color: #2c3e50;
            font-size: 19px;
            margin-bottom: 18px;
            font-weight: 700;
            border-bottom: 2px solid #F1C40F;
            padding-bottom: 8px;
        }
        
        .transition-section p {
            line-height: 1.7;
            margin-bottom: 18px;
            color: #2c3e50;
            text-align: justify;
        }
        
        .transition-section ul {
            padding-left: 25px;
        }
        
        .transition-section li {
            margin-bottom: 10px;
            line-height: 1.6;
            color: #34495e;
            position: relative;
        }
        
        .transition-section li:before {
            content: '';
            position: absolute;
            left: -15px;
            top: 8px;
            width: 6px;
            height: 6px;
            background: #F1C40F;
            border-radius: 50%;
        }
        
        .pricing-table {
            border-collapse: collapse;
            width: 100%;
            margin: 25px 0;
            border: 2px solid #3498db;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(52,152,219,0.2);
        }
        
        .pricing-table th {
            background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
            color: white;
            padding: 18px 12px;
            text-align: center;
            font-weight: 600;
            font-size: 12px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
        }
        
        .pricing-table td {
            padding: 15px 12px;
            text-align: center;
            border-bottom: 1px solid #ecf0f1;
            font-size: 12px;
            color: #2c3e50;
            font-weight: 500;
            background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%);
        }
        
        .pricing-table tr:last-child td {
            border-bottom: none;
        }
        
        .acceptance-section {
            margin-top: 35px;
            padding: 25px;
            background: linear-gradient(135deg, #e8f5e8 0%, #f0f8f0 100%);
            border-radius: 15px;
            border-left: 4px solid #27ae60;
        }
        
        .acceptance-section h3 {
            color: #27ae60;
            font-size: 15px;
            margin-bottom: 12px;
            font-weight: 600;
        }
        
        .acceptance-section p {
            color: #2c3e50;
            line-height: 1.6;
            margin-bottom: 15px;
        }
        
        .acceptance-section ul {
            padding-left: 25px;
        }
        
        .acceptance-section li {
            margin-bottom: 8px;
            line-height: 1.5;
            color: #34495e;
        }
        
        /* ROI Summary Page */
        .roi-page {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #667eea 100%);
            color: white;
            min-height: 100vh;
            page-break-before: always;
            page-break-inside: avoid;
            display: flex;
            flex-direction: column;
            position: relative;
            overflow: hidden;
        }
        
        .roi-page:before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: radial-gradient(circle at 30% 20%, rgba(255,255,255,0.1) 0%, transparent 50%),
                        radial-gradient(circle at 70% 80%, rgba(255,255,255,0.08) 0%, transparent 50%);
            pointer-events: none;
        }
        
        .roi-content {
            padding: 45px 50px;
            flex: 1;
            position: relative;
            z-index: 1;
        }
        
        .roi-content h1 {
            font-size: 48px;
            margin-bottom: 35px;
            text-transform: uppercase;
            font-weight: 900;
            text-shadow: 3px 3px 8px rgba(0,0,0,0.4);
            letter-spacing: -1px;
        }
        
        .roi-content > p {
            font-size: 16px;
            line-height: 1.7;
            margin-bottom: 35px;
            background: rgba(255,255,255,0.1);
            padding: 20px;
            border-radius: 12px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.2);
        }
        
        .metrics-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin: 35px 0;
        }
        
        .metric-box {
            background: rgba(255,255,255,0.15);
            border-radius: 15px;
            padding: 30px;
            text-align: center;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.2);
            box-shadow: 0 8px 25px rgba(0,0,0,0.2);
            transition: all 0.3s ease;
        }
        
        .metric-box:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 35px rgba(0,0,0,0.3);
        }
        
        .metric-value {
            font-size: 42px;
            font-weight: 900;
            margin-bottom: 12px;
            text-shadow: 2px 2px 6px rgba(0,0,0,0.4);
            background: linear-gradient(45deg, #ffffff 0%, #f1c40f 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .metric-label {
            font-size: 14px;
            opacity: 0.95;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .roi-summary {
            background: rgba(255,255,255,0.1);
            border-radius: 15px;
            padding: 30px;
            margin-top: 35px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.2);
            box-shadow: 0 8px 25px rgba(0,0,0,0.2);
        }
        
        .roi-summary h3 {
            margin-bottom: 20px;
            font-size: 18px;
            text-shadow: 1px 1px 3px rgba(0,0,0,0.3);
        }
        
        .roi-breakdown {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 35px;
            margin: 25px 0;
        }
        
        .roi-breakdown ul {
            list-style: none;
            padding: 0;
            margin: 0;
        }
        
        .roi-breakdown li {
            margin-bottom: 10px;
            font-weight: 600;
            position: relative;
            padding-left: 25px;
        }
        
        .roi-breakdown li:before {
            content: '';
            position: absolute;
            left: 0;
            top: 8px;
            width: 8px;
            height: 8px;
            background: #F1C40F;
            border-radius: 50%;
            box-shadow: 0 0 8px rgba(241,196,15,0.5);
        }
        
        .final-recommendation {
            text-align: center;
            margin-top: 35px;
            padding: 25px;
            background: rgba(255,255,255,0.15);
            border-radius: 15px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.3);
            box-shadow: 0 8px 25px rgba(0,0,0,0.2);
        }
        
        .final-recommendation h3 {
            margin-bottom: 18px;
            font-size: 20px;
            text-shadow: 1px 1px 3px rgba(0,0,0,0.3);
        }
        
        .final-recommendation p {
            font-size: 16px;
            font-weight: 600;
            line-height: 1.6;
        }
        
        /* Signature Section */
        .signature-page {
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            page-break-before: always;
            page-break-inside: avoid;
            background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%);
        }
        
        .signature-content {
            padding: 45px 50px;
            flex: 1;
            background: white;
            border-radius: 0 0 20px 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .signature-section {
            margin-top: 35px;
            padding: 30px;
            background: linear-gradient(135deg, #f8f9fa 0%, #ffffff 100%);
            border-radius: 15px;
            border: 2px solid #F1C40F;
        }
        
        .signature-section h2 {
            color: #2c3e50;
            font-size: 19px;
            margin-bottom: 25px;
            font-weight: 700;
            text-align: center;
            text-transform: uppercase;
        }
        
        .signature-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 50px;
            margin-top: 30px;
        }
        
        .signature-block {
            text-align: center;
        }
        
        .signature-line {
            border-bottom: 2px solid #2c3e50;
            width: 100%;
            height: 50px;
            margin-bottom: 10px;
            position: relative;
        }
        
        .signature-label {
            font-weight: 600;
            color: #2c3e50;
            font-size: 14px;
            margin-bottom: 5px;
        }
        
        .signature-details {
            font-size: 12px;
            color: #7f8c8d;
            line-height: 1.4;
        }
        
        .acceptance-text {
            margin-bottom: 30px;
            padding: 20px;
            background: rgba(241, 196, 15, 0.1);
            border-radius: 8px;
            border-left: 4px solid #F1C40F;
            font-size: 13px;
            line-height: 1.6;
            color: #2c3e50;
        }
        
        @media print {
            body { 
                -webkit-print-color-adjust: exact;
                margin: 0;
                padding: 0;
            }
            .page-break { page-break-before: always; }
            
            /* Ensure pages don't break in the middle of content */
            .roi-page, .investment-page, .signature-page, .sow-page {
                page-break-inside: avoid;
                margin: 0;
                padding: 0;
                box-sizing: border-box;
            }
            
            /* Fix content overflow */
            .roi-content, .investment-content, .signature-content, .section-content {
                max-height: calc(100vh - 200px);
                overflow: visible;
                page-break-inside: avoid;
            }
            
            /* Ensure all text is visible */
            * {
                box-sizing: border-box;
                -webkit-print-color-adjust: exact;
                color-adjust: exact;
            }
        }
    </style>
</head>
<body>
    <!-- Cover Page -->
    <div class="cover-page">
        <div class="sax-logo">
            <div class="main-logo">SA<span class="yellow">X</span></div>
            <div class="tagline">Technology Advisors</div>
        </div>
        
        <div class="client-name" id="coverClientName">
            FCS GROUP, LLC
        </div>
        
        <div class="cover-footer">
            <h3>CREATED BY:</h3>
            <div>
                Leon Grassi, Partner, CRO<br>
                Sax Technology Advisors
            </div>
            
            <h3>PREPARED FOR:</h3>
            <div>
                <span id="footerClientContact">Neil Singh, President</span><br>
                <span id="footerClientCompany">FCS Group, LLC</span>
            </div>
        </div>
    </div>
    
    <!-- Executive Summary Page -->
    <div class="exec-summary-page">
        <div class="page-header">
            <h1>Executive Summary</h1>
            <div class="yellow-arrow"></div>
        </div>
        
        <div class="page-content">
            <div class="client-info">
                <span id="execClientContact">Neil Singh</span><br>
                <span id="execClientCompany">FCS Group, LLC</span><br>
                <span id="execClientAddress">60 Fadem Road<br>Springfield, NJ 07081</span>
                <div class="date-right" id="proposalDate">2025-01-15</div>
            </div>
            
            <div class="letter-content">
                <p>Dear <span id="execClientFirstName">Neil</span>,</p>
                
                <p>Sax appreciates the opportunity to provide you with our engagement details for the development of an automation solution for <span id="processNameLower">project estimating</span>. We are committed to being our clients' number one advisor by understanding their vision and providing solutions that exceed expectations to assure their success. We are dedicated to continually building a great firm that attracts, develops, excites and retains exceptional people.</p>
                
                <p>Our differentiation is in our approach - we are business people with expertise in technology, <em>not the other way around</em>, which is why we strive to bring new ideas to the table that help you exceed your goals. The better we understand your business, your marketplace, and your people - the better we can be in helping you to achieve your business initiatives. The Sax team strives to be both consultative and proactive which is why we meet with clients quarterly so there is always a scheduled touch point. We encourage our clients to include their engagement team in these meetings so that we can focus on the most important issues at hand and drive success together.</p>
                
                <p>We look forward to working with you, and welcome any questions or comments that you have regarding this proposal.</p>
                
                <div class="signature">
                    Sincerely,<br>
                    Sax Technology Services<br>
                    Leon Grassi
                </div>
            </div>
        </div>
    </div>
    
    <!-- SAX Added Value Page -->
    <div class="sax-value-page">
        <div class="page-header">
            <h1>SAX Added Value</h1>
            <div class="yellow-arrow"></div>
        </div>
        
        <div class="value-content">
            <div class="value-grid">
                <div class="value-item">
                    <h3>Transaction Advisory & Transformation</h3>
                    <p>We are an M&A leader who works on our clients' behalf to ensure they are strategically positioned, identifying and realizing value during the due diligence process and throughout the entirety of the transaction.</p>
                </div>
                
                <div class="value-item">
                    <h3>Fractional Finance</h3>
                    <p>Whether it's a temporary engagement or a CFO level resource part time – SAX Fractional Finance is here to support a business' needs. We can step in at any time and provide strategic thinking to maximize opportunities within a wide range of industries.</p>
                </div>
                
                <div class="value-item">
                    <h3>Investment Banking</h3>
                    <p>Our team has a wealth of expertise needed to assist in finding the perfect partner when selling or acquiring a business, preparing your business for sale, raising capital, and/or restructuring your company, and more.</p>
                </div>
                
                <div class="value-item">
                    <h3>Strategic Business Transformation</h3>
                    <p>SAX takes its advisory services one step further by providing 360 consulting via a full range of comprehensive and project-based services. Paired with our already robust services, our team will focus on creating strategic and innovative solutions to propel you forward.</p>
                </div>
                
                <div class="value-item">
                    <h3>Private Client</h3>
                    <p>Our dedicated Private Client Services team offers tailored solutions, ensuring the utmost confidentiality while taking a comprehensive approach to wealth management. We assist in managing wealth, preserving legacy, and ensuring financial security.</p>
                </div>
                
                <div class="value-item">
                    <h3>Valuation, Forensic & Litigation</h3>
                    <p>Whether it is litigation, investigating potential fraud, Alternative Dispute Resolution or just trying to find a solution to a complex financial situation, we can help navigate through the intricacies of any matter.</p>
                </div>
                
                <div class="value-item">
                    <h3>HR Consulting</h3>
                    <p>We provide companies with a level of HR support to help make strategic long-term and day-to-day business decisions, and keep up with the changing regulatory and industry standards.</p>
                </div>
                
                <div class="value-item">
                    <h3>Wealth Management</h3>
                    <p>SAX Wealth Advisors delivers wealth management solutions like financial planning, investment management, individual and employer retirement plans and more.</p>
                </div>
            </div>
        </div>
    </div>
    
    <!-- SOW Page 1 -->
    <div class="sow-page">
        <div class="page-header">
            <h1>SOW</h1>
            <div class="yellow-arrow"></div>
        </div>
        
        <div class="section-content">
            <h2>Project Overview:</h2>
            <p>SAX Technology Advisors will design and deploy an AI-powered automation solution using Azure cloud services and SAXTech Automation Engine workflow orchestration to enhance <span id="processNameSOW">project estimating</span> accessibility and efficiency. The solution will be hosted exclusively in the SAX Tech Azure tenant, fully managed by SAX Tech, with no client administrative control.</p>
            
            <p>The implementation will validate the solution's business value and provide a foundation for a scalable managed service with predictable monthly recurring revenue (MRR) post-pilot.</p>
            
            <h2>Scope of Work</h2>
            
            <h3>Activities and Deliverables</h3>
            <div id="activitiesAndDeliverables">
                <!-- Dynamic activities and deliverables will be inserted here -->
            </div>
        </div>
    </div>
    
    <!-- SOW Page 2 -->
    <div class="sow-page">
        <div class="page-header">
            <h1>SOW</h1>
            <div class="yellow-arrow"></div>
        </div>
        
        <div class="section-content">
            
            <h3>Security & Access Controls</h3>
            <ul>
                <li>The environment is hosted and managed by SAX Tech under strict access controls.</li>
                <li>Single Sign-On (SSO) integration is available for client access.</li>
                <li>Multi-Factor Authentication (MFA) is highly suggest for user access and required for Sax Tech Administrative access</li>
                <li>The solution inherits Microsoft Azure's compliance posture, which includes adherence to SOC 2 Type II, ISO 27001, and other published security certifications.</li>
            </ul>
            
            <h3>Knowledge Transfer & Demo</h3>
            <ul>
                <li>Provide a live demonstration of the functionality.</li>
                <li>Deliver a findings report with recommendations for scaling to production.</li>
                <li>Conduct a knowledge transfer session with stakeholders.</li>
            </ul>
            
            <h3>Out of Scope</h3>
            <div id="outOfScopeItems">
                <!-- Dynamic out of scope items will be inserted here -->
            </div>
            
            <h3>Current State Analysis</h3>
            <div id="currentStateAnalysis">
                <!-- Dynamic current state content will be inserted here -->
            </div>
            
            <h3>Proposed Solution Overview</h3>
            <div id="proposedSolution">
                <!-- Dynamic solution overview content will be inserted here -->
            </div>
            
            <h3>Implementation Cost Breakdown</h3>
            <div id="implementationBreakdown" class="pricing-box">
                <!-- Dynamic implementation cost breakdown will be inserted here -->
            </div>
            
            <h3>Monthly Managed Service Breakdown</h3>
            <div id="monthlyServiceBreakdown" class="pricing-box">
                <!-- Dynamic monthly service breakdown will be inserted here -->
            </div>
        </div>
    </div>
    
    <!-- Investment Summary Page -->
    <div class="investment-page">
        <div class="page-header">
            <h1>Investment Summary</h1>
            <div class="yellow-arrow"></div>
        </div>
        
        <div class="investment-content">
            
            <div class="transition-section">
                <h2>Added Value & Benefits</h2>
                <div id="addedValueSection">
                    <!-- Dynamic added value content will be inserted here -->
                </div>
            </div>
            
            <div class="transition-section">
                <h2>Transition to Managed Service</h2>
                <p>Upon implementation completion, the solution will transition into a fully managed service operated by SAX Tech. This service includes:</p>
                <ul>
                    <li>Complete hosting and management within the SAX Tech environment</li>
                    <li>Ongoing updates, monitoring, and optimization</li>
                    <li>Scaling of users, document volume, and workflows as business needs grow</li>
                </ul>
                
                <h2>Managed Services Pricing (Post Implementation):</h2>
                
                <div id="managedServicesPricingBreakdown" class="pricing-box">
                    <!-- Dynamic monthly managed services breakdown will be inserted here -->
                </div>
            </div>
            
            <div class="acceptance-section">
                <h3>Acceptance Criteria</h3>
                <div id="acceptanceCriteria">
                    <!-- Dynamic acceptance criteria will be inserted here -->
                </div>
                
                <h3>Assumptions</h3>
                <div id="projectAssumptions">
                    <!-- Dynamic project assumptions will be inserted here -->
                </div>
            </div>
        </div>
    </div>
    
    <!-- ROI Summary Page -->
    <div class="roi-page">
        <div class="roi-content">
            <!-- Executive Summary Section (matching ROI calculator) -->
            <div style="background: rgba(255,255,255,0.15); border-radius: 15px; padding: 25px; margin-bottom: 30px; backdrop-filter: blur(10px); border: 1px solid rgba(255,255,255,0.3);">
                <h2 style="color: white; text-align: center; margin-bottom: 25px; font-size: 24px; text-shadow: 2px 2px 4px rgba(0,0,0,0.3);">Executive Summary</h2>
                <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 15px;">
                    <div style="background: rgba(255,255,255,0.2); border-radius: 10px; padding: 20px; text-align: center; backdrop-filter: blur(5px);">
                        <div style="font-size: 24px; font-weight: bold; color: white; margin-bottom: 5px;">$<span id="execSummaryAnnualSavings">86,040</span></div>
                        <div style="font-size: 12px; color: rgba(255,255,255,0.9); font-weight: 600;">Annual Labor Cost Savings</div>
                    </div>
                    <div style="background: rgba(255,255,255,0.2); border-radius: 10px; padding: 20px; text-align: center; backdrop-filter: blur(5px);">
                        <div style="font-size: 24px; font-weight: bold; color: white; margin-bottom: 5px;"><span id="execSummaryTimeReduction">86.7</span>%</div>
                        <div style="font-size: 12px; color: rgba(255,255,255,0.9); font-weight: 600;">Time Reduction</div>
                    </div>
                    <div style="background: rgba(255,255,255,0.2); border-radius: 10px; padding: 20px; text-align: center; backdrop-filter: blur(5px);">
                        <div style="font-size: 24px; font-weight: bold; color: white; margin-bottom: 5px;"><span id="execSummaryPaybackPeriod">4.9</span> Months</div>
                        <div style="font-size: 12px; color: rgba(255,255,255,0.9); font-weight: 600;">Payback Period</div>
                    </div>
                    <div style="background: rgba(255,255,255,0.2); border-radius: 10px; padding: 20px; text-align: center; backdrop-filter: blur(5px);">
                        <div style="font-size: 24px; font-weight: bold; color: white; margin-bottom: 5px;"><span id="execSummaryFirstYearROI">143</span>%</div>
                        <div style="font-size: 12px; color: rgba(255,255,255,0.9); font-weight: 600;">First Year ROI</div>
                    </div>
                </div>
            </div>

            <!-- ROI Model Analysis Table -->
            <div style="background: rgba(255,255,255,0.15); border-radius: 15px; padding: 25px; margin-bottom: 30px; backdrop-filter: blur(10px); border: 1px solid rgba(255,255,255,0.3);">
                <h3 style="color: white; text-align: center; margin-bottom: 20px; font-size: 20px; text-shadow: 2px 2px 4px rgba(0,0,0,0.3);">Return on Investment Analysis</h3>
                
                <!-- 3-Year ROI Table -->
                <div style="overflow-x: auto; margin-bottom: 20px;">
                    <table style="width: 100%; border-collapse: collapse; background: rgba(255,255,255,0.9); border-radius: 10px; overflow: hidden; font-size: 11px;">
                        <thead>
                            <tr style="background: rgba(0,0,0,0.7);">
                                <th style="padding: 12px 8px; text-align: left; color: white; font-weight: 600; border-bottom: 2px solid #F1C40F;">ROI Component</th>
                                <th style="padding: 12px 8px; text-align: center; color: white; font-weight: 600; border-bottom: 2px solid #F1C40F;">Year 1</th>
                                <th style="padding: 12px 8px; text-align: center; color: white; font-weight: 600; border-bottom: 2px solid #F1C40F;">Year 2</th>
                                <th style="padding: 12px 8px; text-align: center; color: white; font-weight: 600; border-bottom: 2px solid #F1C40F;">3-Year Total</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- Investment Section -->
                            <tr style="background: rgba(0,0,0,0.05);">
                                <td colspan="4" style="padding: 8px; font-weight: 600; color: #2c3e50; background: rgba(52,152,219,0.1);"><strong>INVESTMENT</strong></td>
                            </tr>
                            <tr>
                                <td style="padding: 8px; color: #2c3e50;">Implementation Cost</td>
                                <td style="padding: 8px; text-align: center; color: #e74c3c; font-weight: 600;">($<span id="roiYear1Implementation">46,500</span>)</td>
                                <td style="padding: 8px; text-align: center; color: #2c3e50;">$0</td>
                                <td style="padding: 8px; text-align: center; color: #e74c3c; font-weight: 600;">($<span id="roi3YearImplementation">46,500</span>)</td>
                            </tr>
                            <tr>
                                <td style="padding: 8px; color: #2c3e50;">Monthly Service Fee</td>
                                <td style="padding: 8px; text-align: center; color: #e74c3c; font-weight: 600;">($<span id="roiYear1Service">25,200</span>)</td>
                                <td style="padding: 8px; text-align: center; color: #e74c3c; font-weight: 600;">($<span id="roiYear2Service">25,200</span>)</td>
                                <td style="padding: 8px; text-align: center; color: #e74c3c; font-weight: 600;">($<span id="roi3YearService">75,600</span>)</td>
                            </tr>
                            <tr style="background: rgba(231,76,60,0.1); border-top: 1px solid rgba(231,76,60,0.3);">
                                <td style="padding: 8px; color: #2c3e50;"><strong>Total Investment</strong></td>
                                <td style="padding: 8px; text-align: center; color: #e74c3c; font-weight: 700;"><strong>($<span id="roiYear1TotalInvest">71,700</span>)</strong></td>
                                <td style="padding: 8px; text-align: center; color: #e74c3c; font-weight: 700;"><strong>($<span id="roiYear2TotalInvest">25,200</span>)</strong></td>
                                <td style="padding: 8px; text-align: center; color: #e74c3c; font-weight: 700;"><strong>($<span id="roi3YearTotalInvest">122,100</span>)</strong></td>
                            </tr>
                            
                            <!-- Benefits Section -->
                            <tr style="background: rgba(0,0,0,0.05);">
                                <td colspan="4" style="padding: 8px; font-weight: 600; color: #2c3e50; background: rgba(39,174,96,0.1);"><strong>BENEFITS</strong></td>
                            </tr>
                            <tr>
                                <td style="padding: 8px; color: #2c3e50;">Labor Cost Savings</td>
                                <td style="padding: 8px; text-align: center; color: #27ae60; font-weight: 600;">$<span id="roiYear1LaborSavings">86,040</span></td>
                                <td style="padding: 8px; text-align: center; color: #27ae60; font-weight: 600;">$<span id="roiYear2LaborSavings">86,040</span></td>
                                <td style="padding: 8px; text-align: center; color: #27ae60; font-weight: 600;">$<span id="roi3YearLaborSavings">258,120</span></td>
                            </tr>
                            <tr>
                                <td style="padding: 8px; color: #2c3e50;">Error Reduction Benefits</td>
                                <td style="padding: 8px; text-align: center; color: #27ae60; font-weight: 600;">$<span id="roiYear1ErrorReduction">15,000</span></td>
                                <td style="padding: 8px; text-align: center; color: #27ae60; font-weight: 600;">$<span id="roiYear2ErrorReduction">15,000</span></td>
                                <td style="padding: 8px; text-align: center; color: #27ae60; font-weight: 600;">$<span id="roi3YearErrorReduction">45,000</span></td>
                            </tr>
                            <tr>
                                <td style="padding: 8px; color: #2c3e50;">Faster Time-to-Revenue</td>
                                <td style="padding: 8px; text-align: center; color: #27ae60; font-weight: 600;">$<span id="roiYear1Revenue">20,000</span></td>
                                <td style="padding: 8px; text-align: center; color: #27ae60; font-weight: 600;">$<span id="roiYear2Revenue">20,000</span></td>
                                <td style="padding: 8px; text-align: center; color: #27ae60; font-weight: 600;">$<span id="roi3YearRevenue">60,000</span></td>
                            </tr>
                            <tr style="background: rgba(39,174,96,0.1); border-top: 1px solid rgba(39,174,96,0.3);">
                                <td style="padding: 8px; color: #2c3e50;"><strong>Total Benefits</strong></td>
                                <td style="padding: 8px; text-align: center; color: #27ae60; font-weight: 700;"><strong>$<span id="roiYear1TotalBenefits">121,040</span></strong></td>
                                <td style="padding: 8px; text-align: center; color: #27ae60; font-weight: 700;"><strong>$<span id="roiYear2TotalBenefits">121,040</span></strong></td>
                                <td style="padding: 8px; text-align: center; color: #27ae60; font-weight: 700;"><strong>$<span id="roi3YearTotalBenefits">363,120</span></strong></td>
                            </tr>
                            
                            <!-- Net Results -->
                            <tr style="background: linear-gradient(135deg, rgba(241,196,15,0.2), rgba(243,156,18,0.2)); border-top: 2px solid #F1C40F;">
                                <td style="padding: 12px 8px; color: #2c3e50;"><strong>NET BENEFIT</strong></td>
                                <td style="padding: 12px 8px; text-align: center; color: #2c3e50; font-weight: 700; font-size: 12px;"><strong>$<span id="roiYear1NetBenefit">49,340</span></strong></td>
                                <td style="padding: 12px 8px; text-align: center; color: #2c3e50; font-weight: 700; font-size: 12px;"><strong>$<span id="roiYear2NetBenefit">95,840</span></strong></td>
                                <td style="padding: 12px 8px; text-align: center; color: #2c3e50; font-weight: 700; font-size: 12px;"><strong>$<span id="roi3YearNetBenefit">241,020</span></strong></td>
                            </tr>
                            <tr style="background: linear-gradient(135deg, rgba(241,196,15,0.3), rgba(243,156,18,0.3));">
                                <td style="padding: 12px 8px; color: #2c3e50;"><strong>ROI PERCENTAGE</strong></td>
                                <td style="padding: 12px 8px; text-align: center; color: #2c3e50; font-weight: 700; font-size: 12px;"><strong><span id="roiYear1Percentage">69</span>%</strong></td>
                                <td style="padding: 12px 8px; text-align: center; color: #2c3e50; font-weight: 700; font-size: 12px;"><strong><span id="roiYear2Percentage">380</span>%</strong></td>
                                <td style="padding: 12px 8px; text-align: center; color: #2c3e50; font-weight: 700; font-size: 12px;"><strong><span id="roi3YearPercentage">197</span>%</strong></td>
                            </tr>
                            <tr style="background: linear-gradient(135deg, rgba(241,196,15,0.4), rgba(243,156,18,0.4));">
                                <td style="padding: 12px 8px; color: #2c3e50;"><strong>PAYBACK PERIOD</strong></td>
                                <td style="padding: 12px 8px; text-align: center; color: #2c3e50; font-weight: 700; font-size: 12px;"><strong><span id="roiPaybackPeriod">4.9</span> months</strong></td>
                                <td style="padding: 12px 8px; text-align: center; color: #7f8c8d;">-</td>
                                <td style="padding: 12px 8px; text-align: center; color: #7f8c8d;">-</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <!-- Key Qualitative Benefits -->
                <div style="background: rgba(255,255,255,0.1); border-radius: 10px; padding: 15px; margin-top: 15px;">
                    <h4 style="color: white; margin-bottom: 10px; font-size: 14px; text-shadow: 1px 1px 2px rgba(0,0,0,0.3);">Additional Qualitative Benefits:</h4>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; font-size: 11px; color: rgba(255,255,255,0.95);">
                        <ul style="margin: 0; padding-left: 15px; line-height: 1.5;">
                            <li>Enhanced Customer Experience: Faster processing times</li>
                            <li>Improved Data Quality: AI validation reduces errors</li>
                            <li>Better Compliance: Automated validation checks</li>
                        </ul>
                        <ul style="margin: 0; padding-left: 15px; line-height: 1.5;">
                            <li>Scalability: Handle 10x volume without staff increases</li>
                            <li>Staff Satisfaction: Eliminates repetitive manual tasks</li>
                            <li>Complete Audit Trail: Digital documentation transparency</li>
                        </ul>
                    </div>
                </div>
            </div>

        </div>
    </div>

    <!-- Signature Page -->
    <div class="signature-page">
        <div class="page-header">
            <h1>Agreement</h1>
            <div class="yellow-arrow"></div>
        </div>
        
        <div class="signature-content">
            <div class="acceptance-text">
                <strong>By signing below, both parties acknowledge and agree to the following:</strong>
                <br><br>
                • The terms, conditions, and pricing outlined in this proposal are accepted as presented<br>
                • The project scope, timeline, and deliverables detailed in this Statement of Work are agreed upon<br>
                • Payment terms follow Net 30 invoice cycles with implementation fee due upon contract signing<br>
                • This agreement is subject to SAX Technology Advisors' standard terms and conditions<br>
                • All intellectual property developed remains the property of SAX Technology Advisors<br>
                • The managed service agreement begins immediately following successful implementation
            </div>
            
            <div class="signature-section">
                <h2>Client Acceptance & Authorization</h2>
                
                <div class="signature-grid">
                    <div class="signature-block">
                        <div class="signature-label">Client Signature</div>
                        <div class="signature-line"></div>
                        <div class="signature-details">
                            Print Name: <span id="signatureClientName">Neil Singh</span><br>
                            Title: <span id="signatureClientTitle">President</span><br>
                            Company: <span id="signatureClientCompany">FCS Group, LLC</span><br>
                            Date: _________________
                        </div>
                    </div>
                    
                    <div class="signature-block">
                        <div class="signature-label">SAX Technology Advisors</div>
                        <div class="signature-line"></div>
                        <div class="signature-details">
                            Print Name: Leon Grassi<br>
                            Title: Partner, CRO<br>
                            Company: SAX Technology Advisors<br>
                            Date: _________________
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Function to populate PDF with data
        function populatePDFData(data) {
            console.log('Populating PDF with data:', data);
            
            // Client information
            const clientName = data.clientInfo?.companyName || 'Company Name';
            const contactName = data.clientInfo?.contactName || 'Contact Name';
            const processName = data.projectOverview?.processName || 'process automation';
            
            // Update all client name references
            document.getElementById('coverClientName').textContent = clientName.toUpperCase();
            document.getElementById('footerClientContact').textContent = contactName;
            document.getElementById('footerClientCompany').textContent = clientName;
            
            // Executive summary page
            document.getElementById('execClientContact').textContent = contactName.split(' ')[0] || 'Contact';
            document.getElementById('execClientCompany').textContent = clientName;
            document.getElementById('execClientAddress').textContent = data.clientInfo?.address || 'Address';
            document.getElementById('execClientFirstName').textContent = contactName.split(' ')[0] || 'Contact';
            document.getElementById('proposalDate').textContent = data.clientInfo?.date || new Date().toISOString().split('T')[0];
            
            // Process name references
            document.getElementById('processNameLower').textContent = processName.toLowerCase();
            document.getElementById('processNameSOW').textContent = processName.toLowerCase();
            
            // **COMMERCIALS DATA - Pull from actual data structure**
            // Implementation cost from the ROI implementation components total
            const implementationCost = data.commercials?.implementationFee?.replace(/[$,]/g, '') || 
                                     data.investmentSummary?.implementationCost?.replace(/[$,]/g, '') || '46500';
            
            // Monthly service cost from ROI monthly service calculation
            const monthlyServiceCost = data.commercials?.monthlyServiceFee?.replace(/[$,]/g, '') || 
                                     data.investmentSummary?.monthlyManagedService?.replace(/[$,]/g, '') || '2100';
            
            console.log('Commercials Data being used:', {
                implementationCost: implementationCost,
                monthlyServiceCost: monthlyServiceCost,
                rawCommercials: data.commercials,
                rawInvestmentSummary: data.investmentSummary
            });
            
            // Implementation timeline from ROI analysis
            const implementationTimeline = data.commercials?.duration || '8–10 weeks';
            
            // Contract length from ROI settings
            const contractLength = data.commercials?.contractLength?.replace('-month minimum', '') || '24';
            
            // Populate comprehensive sections
            populateCurrentStateAnalysis(data);
            populateProposedSolution(data);
            populateImplementationBreakdown(data);
            populateMonthlyServiceBreakdown(data);
            populateProjectTimeline(data);
            populateActivitiesAndDeliverables(data);
            populateOutOfScope(data);
            populateAcceptanceCriteria(data);
            populateProjectAssumptions(data);
            populateManagedServicesPricing(data);
            populateAddedValue(data);
            
            // ROI metrics from the analysis - use actual data structure from generatePDFData
            const annualSavings = data.investmentSummary?.annualLaborSavings?.replace(/[$,]/g, '') || '86040';
            const timeReduction = data.investmentSummary?.timeReduction?.replace('%', '') || '86.7';
            const paybackPeriod = data.investmentSummary?.paybackPeriod || '4.9';
            const firstYearROI = data.investmentSummary?.firstYearROI?.replace('%', '') || '143';
            
            console.log('ROI Data being used:', {
                annualSavings: annualSavings,
                timeReduction: timeReduction,
                paybackPeriod: paybackPeriod,
                firstYearROI: firstYearROI,
                rawData: data.investmentSummary
            });
            
            // Populate Executive Summary metrics (top of ROI page)
            document.getElementById('execSummaryAnnualSavings').textContent = parseInt(annualSavings).toLocaleString();
            document.getElementById('execSummaryTimeReduction').textContent = timeReduction;
            document.getElementById('execSummaryPaybackPeriod').textContent = paybackPeriod;
            document.getElementById('execSummaryFirstYearROI').textContent = firstYearROI;
            
            // Populate the new ROI Model Analysis Table
            const numImplementationCost = parseInt(implementationCost);
            const numMonthlyServiceCost = parseInt(monthlyServiceCost);
            const numAnnualSavings = parseInt(annualSavings);
            
            // Year 1 calculations
            const year1Implementation = numImplementationCost;
            const year1Service = numMonthlyServiceCost * 12;
            const year1TotalInvestment = year1Implementation + year1Service;
            
            // Year 2 calculations (only service fees)
            const year2Service = numMonthlyServiceCost * 12;
            const year2TotalInvestment = year2Service;
            
            // 3-Year total calculations
            const threeYearImplementation = numImplementationCost;
            const threeYearService = numMonthlyServiceCost * 36; // 3 years
            const threeYearTotalInvestment = threeYearImplementation + threeYearService;
            
            // Benefits (assuming consistent year over year)
            const year1LaborSavings = numAnnualSavings;
            const year2LaborSavings = numAnnualSavings;
            const threeYearLaborSavings = numAnnualSavings * 3;
            
            // Additional benefits (use data or defaults)
            const errorReductionBenefit = data.investmentSummary?.errorReductionBenefit ? 
                parseInt(data.investmentSummary.errorReductionBenefit.replace(/[$,]/g, '')) : 15000;
            const revenueAccelerationBenefit = data.investmentSummary?.revenueAccelerationBenefit ? 
                parseInt(data.investmentSummary.revenueAccelerationBenefit.replace(/[$,]/g, '')) : 20000;
            
            const year1ErrorReduction = errorReductionBenefit;
            const year2ErrorReduction = errorReductionBenefit;
            const threeYearErrorReduction = errorReductionBenefit * 3;
            
            const year1Revenue = revenueAccelerationBenefit;
            const year2Revenue = revenueAccelerationBenefit;
            const threeYearRevenue = revenueAccelerationBenefit * 3;
            
            // Total benefits
            const year1TotalBenefits = year1LaborSavings + year1ErrorReduction + year1Revenue;
            const year2TotalBenefits = year2LaborSavings + year2ErrorReduction + year2Revenue;
            const threeYearTotalBenefits = threeYearLaborSavings + threeYearErrorReduction + threeYearRevenue;
            
            // Net benefits
            const year1NetBenefit = year1TotalBenefits - year1TotalInvestment;
            const year2NetBenefit = year2TotalBenefits - year2TotalInvestment;
            const threeYearNetBenefit = threeYearTotalBenefits - threeYearTotalInvestment;
            
            // ROI percentages
            const year1ROI = Math.round((year1NetBenefit / year1TotalInvestment) * 100);
            const year2ROI = Math.round((year2NetBenefit / year2TotalInvestment) * 100);
            const threeYearROI = Math.round((threeYearNetBenefit / threeYearTotalInvestment) * 100);
            
            // Investment section
            document.getElementById('roiYear1Implementation').textContent = year1Implementation.toLocaleString();
            document.getElementById('roi3YearImplementation').textContent = threeYearImplementation.toLocaleString();
            
            document.getElementById('roiYear1Service').textContent = year1Service.toLocaleString();
            document.getElementById('roiYear2Service').textContent = year2Service.toLocaleString();
            document.getElementById('roi3YearService').textContent = threeYearService.toLocaleString();
            
            document.getElementById('roiYear1TotalInvest').textContent = year1TotalInvestment.toLocaleString();
            document.getElementById('roiYear2TotalInvest').textContent = year2TotalInvestment.toLocaleString();
            document.getElementById('roi3YearTotalInvest').textContent = threeYearTotalInvestment.toLocaleString();
            
            // Benefits section
            document.getElementById('roiYear1LaborSavings').textContent = year1LaborSavings.toLocaleString();
            document.getElementById('roiYear2LaborSavings').textContent = year2LaborSavings.toLocaleString();
            document.getElementById('roi3YearLaborSavings').textContent = threeYearLaborSavings.toLocaleString();
            
            document.getElementById('roiYear1ErrorReduction').textContent = year1ErrorReduction.toLocaleString();
            document.getElementById('roiYear2ErrorReduction').textContent = year2ErrorReduction.toLocaleString();
            document.getElementById('roi3YearErrorReduction').textContent = threeYearErrorReduction.toLocaleString();
            
            document.getElementById('roiYear1Revenue').textContent = year1Revenue.toLocaleString();
            document.getElementById('roiYear2Revenue').textContent = year2Revenue.toLocaleString();
            document.getElementById('roi3YearRevenue').textContent = threeYearRevenue.toLocaleString();
            
            document.getElementById('roiYear1TotalBenefits').textContent = year1TotalBenefits.toLocaleString();
            document.getElementById('roiYear2TotalBenefits').textContent = year2TotalBenefits.toLocaleString();
            document.getElementById('roi3YearTotalBenefits').textContent = threeYearTotalBenefits.toLocaleString();
            
            // Net results
            document.getElementById('roiYear1NetBenefit').textContent = year1NetBenefit.toLocaleString();
            document.getElementById('roiYear2NetBenefit').textContent = year2NetBenefit.toLocaleString();
            document.getElementById('roi3YearNetBenefit').textContent = threeYearNetBenefit.toLocaleString();
            
            document.getElementById('roiYear1Percentage').textContent = year1ROI;
            document.getElementById('roiYear2Percentage').textContent = year2ROI;
            document.getElementById('roi3YearPercentage').textContent = threeYearROI;
            
            document.getElementById('roiPaybackPeriod').textContent = paybackPeriod;
            
            // Old total metrics elements (keep for backward compatibility if they exist)
            const totalAnnualSavingsEl = document.getElementById('totalAnnualSavings');
            if (totalAnnualSavingsEl) {
                totalAnnualSavingsEl.textContent = parseInt(annualSavings).toLocaleString();
                document.getElementById('totalTimeReduction').textContent = timeReduction;
                document.getElementById('totalPaybackPeriod').textContent = paybackPeriod;
                document.getElementById('totalFirstYearROI').textContent = firstYearROI;
            }
            
            // ROI page
            document.getElementById('roiClientName').textContent = clientName;
            document.getElementById('roiProcessName').textContent = processName.toLowerCase();
            document.getElementById('strategicTimeReduction').textContent = timeReduction;
            document.getElementById('finalPaybackPeriod').textContent = paybackPeriod;
            
            // Calculate investment summary from ROI data
            const year1Implementation = parseInt(implementationCost);
            const year1Service = parseInt(monthlyServiceCost) * 12;
            const year1Total = year1Implementation + year1Service;
            const year1Benefits = parseInt(annualSavings);
            const year1Net = year1Benefits - year1Total;
            
            document.getElementById('year1TotalInvestment').textContent = year1Total.toLocaleString();
            document.getElementById('year1NetSavings').textContent = year1Net.toLocaleString();
            document.getElementById('partnerHoursFreed').textContent = data.investmentSummary?.partnerHoursFreed || '240';
            document.getElementById('threeYearROI').textContent = data.investmentSummary?.threeYearNetBenefit || '265';
            document.getElementById('contractLengthFinal').textContent = contractLength;
            document.getElementById('implementationTimelineFinal').textContent = implementationTimeline.replace('Approximately ', '').replace(' weeks', '-week');
            
            // Populate signature section
            document.getElementById('signatureClientName').textContent = contactName;
            document.getElementById('signatureClientTitle').textContent = data.clientInfo?.title || 'President';
            document.getElementById('signatureClientCompany').textContent = clientName;
        }
        
        // Helper function to populate current state analysis
        function populateCurrentStateAnalysis(data) {
            const container = document.getElementById('currentStateAnalysis');
            if (!container) return;
            
            const analysis = data.processAnalysis || {};
            const manualTime = analysis.manualTime || 0;
            const manualCost = analysis.costPerProcess?.manual || 0;
            
            container.innerHTML = `
                <p>The current ${data.projectOverview?.processName || 'process'} involves multiple manual steps requiring approximately ${Math.round(manualTime)} minutes per instance at a cost of $${manualCost.toFixed(2)} per process.</p>
                <p>This manual approach involves multiple stakeholders, creates opportunities for errors, and limits scalability as volume increases. The process requires significant coordination and is prone to delays and inconsistencies.</p>
            `;
        }
        
        // Helper function to populate proposed solution
        function populateProposedSolution(data) {
            const container = document.getElementById('proposedSolution');
            if (!container) return;
            
            const analysis = data.processAnalysis || {};
            const automatedStepsArray = analysis.automatedSteps || [];
            const automatedStepsCount = Array.isArray(automatedStepsArray) ? automatedStepsArray.length : (analysis.automatedSteps || 0);
            const automatedTime = analysis.automatedTime || 0;
            const timeReduction = data.investmentSummary?.timeReduction || '0%';
            
            container.innerHTML = `
                <p>The proposed automation solution streamlines the process to ${automatedStepsCount} automated steps, completing in approximately ${Math.round(automatedTime)} minutes - a ${timeReduction} reduction in processing time.</p>
                
                <h4>Key Automation Benefits:</h4>
                <ul>
                    <li><strong>Eliminates manual data entry</strong> and reduces human errors</li>
                    <li><strong>Provides real-time processing</strong> with instant notifications</li>
                    <li><strong>Enables scalability</strong> without proportional staff increases</li>
                    <li><strong>Creates comprehensive audit trails</strong> and automated reporting</li>
                    <li><strong>Integrates seamlessly</strong> with existing business systems</li>
                    <li><strong>AI-powered intelligence</strong> for enhanced decision-making accuracy</li>
                </ul>
            `;
        }
        
        // Helper function to populate implementation breakdown
        function populateImplementationBreakdown(data) {
            const container = document.getElementById('implementationBreakdown');
            if (!container) return;
            
            const implCost = data.commercials?.implementationFee?.replace(/[$,]/g, '') || '46500';
            const components = data.implementationComponents || [
                { name: 'Project Management & Planning', hours: 40, rate: 200 },
                { name: 'System Architecture & Design', hours: 60, rate: 200 },
                { name: 'AI Model Development & Training', hours: 80, rate: 200 },
                { name: 'Integration Development', hours: 100, rate: 175 },
                { name: 'Testing & Quality Assurance', hours: 40, rate: 150 },
                { name: 'Deployment & Configuration', hours: 30, rate: 175 },
                { name: 'Documentation & Training', hours: 20, rate: 150 }
            ];
            
            const totalImplCost = parseInt(implCost);
            let componentHTML = '<ul>';
            
            components.forEach(comp => {
                const cost = (comp.hours * comp.rate);
                componentHTML += `<li><strong>${comp.name}:</strong> ${comp.hours} hours @ $${comp.rate}/hr = $${cost.toLocaleString()}</li>`;
            });
            
            componentHTML += `<li style="border-top: 1px solid #ddd; margin-top: 10px; padding-top: 10px;"><strong>Total Implementation Fee: $${totalImplCost.toLocaleString()}</strong></li>`;
            componentHTML += '</ul>';
            
            container.innerHTML = componentHTML;
        }
        
        // Helper function to populate monthly service breakdown
        function populateMonthlyServiceBreakdown(data) {
            const container = document.getElementById('monthlyServiceBreakdown');
            if (!container) return;
            
            const monthlyCost = data.commercials?.monthlyServiceFee?.replace(/[$,]/g, '') || '2100';
            const monthlyTotal = parseInt(monthlyCost);
            
            const breakdown = [
                { name: 'Infrastructure & Hosting', cost: Math.round(monthlyTotal * 0.3) },
                { name: 'AI Processing & API Costs', cost: Math.round(monthlyTotal * 0.25) },
                { name: 'Monitoring & Support', cost: Math.round(monthlyTotal * 0.2) },
                { name: 'Platform Management', cost: Math.round(monthlyTotal * 0.15) },
                { name: 'Updates & Optimization', cost: Math.round(monthlyTotal * 0.1) }
            ];
            
            let breakdownHTML = '<ul>';
            breakdown.forEach(item => {
                breakdownHTML += `<li><strong>${item.name}:</strong> $${item.cost.toLocaleString()}/month</li>`;
            });
            breakdownHTML += `<li style="border-top: 1px solid #ddd; margin-top: 10px; padding-top: 10px;"><strong>Total Monthly Service Fee: $${monthlyTotal.toLocaleString()}</strong></li>`;
            breakdownHTML += '</ul>';
            
            container.innerHTML = breakdownHTML;
        }
        
        // Helper function to populate project timeline
        function populateProjectTimeline(data) {
            const container = document.getElementById('projectTimeline');
            if (!container) return;
            
            const phases = data.timelinePhases || [
                { name: 'Discovery & Planning', duration: '2 weeks', deliverables: ['Requirements analysis', 'Architecture design', 'Project plan'] },
                { name: 'Development & Integration', duration: '4 weeks', deliverables: ['Core automation development', 'System integrations', 'Testing & validation'] },
                { name: 'Training & Deployment', duration: '2 weeks', deliverables: ['User training', 'Production deployment', 'Go-live support'] }
            ];
            
            let timelineHTML = '';
            phases.forEach((phase, index) => {
                const phaseName = phase.name || `Phase ${index + 1}`;
                const duration = phase.duration || 'TBD';
                const deliverables = phase.deliverables || [];
                
                timelineHTML += `
                    <h4>Phase ${index + 1}: ${phaseName} (${duration})</h4>
                    <ul>
                        ${deliverables.map(deliverable => `<li>${deliverable}</li>`).join('')}
                    </ul>
                `;
            });
            
            container.innerHTML = timelineHTML;
        }
        
        // Helper function to populate risk mitigation
        function populateRiskMitigation(data) {
            const container = document.getElementById('riskMitigationSection');
            if (!container) return;
            
            const risks = data.risks || [
                { factor: 'Implementation Delays', probability: 'Low', impact: 'Medium', mitigation: 'Experienced project management and phased approach' },
                { factor: 'User Adoption', probability: 'Medium', impact: 'Medium', mitigation: 'Comprehensive training and change management support' }
            ];
            
            let riskHTML = '<div class="risk-factors">';
            risks.forEach(risk => {
                riskHTML += `
                    <div style="margin-bottom: 15px; padding: 10px; background: #f8f9fa; border-radius: 5px;">
                        <h4>${risk.factor}</h4>
                        <p><strong>Probability:</strong> ${risk.probability} | <strong>Impact:</strong> ${risk.impact}</p>
                        <p><strong>Mitigation:</strong> ${risk.mitigation}</p>
                    </div>
                `;
            });
            riskHTML += '</div>';
            
            container.innerHTML = riskHTML;
        }
        
        // Helper function to populate added value
        function populateAddedValue(data) {
            const container = document.getElementById('addedValueSection');
            if (!container) return;
            
            const benefits = data.addedValue || [
                'AI-powered intelligent decision making',
                'Real-time process monitoring and alerts',
                'Seamless integration with existing systems',
                'Enterprise-grade security and compliance',
                'Scalable cloud-based architecture',
                'Continuous optimization and improvement'
            ];
            
            let benefitsHTML = '<ul>';
            benefits.forEach(benefit => {
                benefitsHTML += `<li>${benefit}</li>`;
            });
            benefitsHTML += '</ul>';
            
            container.innerHTML = benefitsHTML;
        }
        
        // Helper function to populate activities and deliverables
        function populateActivitiesAndDeliverables(data) {
            const container = document.getElementById('activitiesAndDeliverables');
            if (!container) return;
            
            const processName = data.projectOverview?.processName || 'process automation';
            const hasAI = data.processAnalysis?.automatedSteps?.some(step => step.isAI) || false;
            const hasIntegrations = data.implementationComponents?.some(comp => comp.name.toLowerCase().includes('integration')) || false;
            
            // Standardized consolidated approach
            let activitiesHTML = `
                <h4>Discovery & Planning (Week 1-2)</h4>
                <ul>
                    <li><strong>Requirements analysis & stakeholder workshops</strong> - Define business objectives and success criteria</li>
                    <li><strong>Current state assessment</strong> - Map existing ${processName.toLowerCase()} workflow and pain points</li>
                    <li><strong>Technical architecture design</strong> - Define system integration points and data flows</li>
                    <li><strong>Project planning</strong> - Finalize timeline, resources, and deliverable schedule</li>
                </ul>
                
                <h4>Development & Configuration (Week 3-6)</h4>
                <ul>
                    <li><strong>Platform setup & configuration</strong> - Deploy SAXTech Automation Engine in Azure environment</li>
                    <li><strong>Workflow development</strong> - Build automated ${processName.toLowerCase()} processing workflows</li>`;
            
            if (hasAI) {
                activitiesHTML += '<li><strong>AI model integration</strong> - Implement intelligent validation and decision-making capabilities</li>';
            }
            
            if (hasIntegrations) {
                activitiesHTML += '<li><strong>System integrations</strong> - Develop API connections with existing business systems</li>';
            }
            
            activitiesHTML += `
                    <li><strong>User interface development</strong> - Create intuitive web interfaces for process initiation</li>
                    <li><strong>Monitoring & alerting setup</strong> - Implement comprehensive logging and notification systems</li>
                </ul>
                
                <h4>Testing & Quality Assurance (Week 7)</h4>
                <ul>
                    <li><strong>Unit & integration testing</strong> - Validate individual components and system interactions</li>
                    <li><strong>User acceptance testing</strong> - Conduct testing sessions with key stakeholders</li>
                    <li><strong>Performance optimization</strong> - Fine-tune workflows for optimal processing speed</li>
                    <li><strong>Security validation</strong> - Ensure compliance with enterprise security standards</li>
                </ul>
                
                <h4>Training, Deployment & Go-Live (Week 8)</h4>
                <ul>
                    <li><strong>Staff training sessions</strong> - Comprehensive user training and documentation handover</li>
                    <li><strong>Production deployment</strong> - Move solution to live environment with data migration</li>
                    <li><strong>Go-live support</strong> - Dedicated support during initial production period</li>
                    <li><strong>Knowledge transfer</strong> - Final documentation delivery and process handover</li>
                </ul>
            `;
            
            container.innerHTML = activitiesHTML;
        }
        
        // Helper function to populate out of scope items
        function populateOutOfScope(data) {
            const container = document.getElementById('outOfScopeItems');
            if (!container) return;
            
            const outOfScope = data.outOfScope || [
                'Legacy system modifications or upgrades',
                'Data migration from systems not included in scope',
                'Custom integrations beyond those specified in scope',
                'Extensive UI/UX customization outside of standard templates',
                'Third-party software licensing costs',
                'On-premise infrastructure or hardware procurement',
                'Business process re-engineering outside of automation scope'
            ];
            
            let scopeHTML = '<ul>';
            outOfScope.forEach(item => {
                scopeHTML += `<li>${item}</li>`;
            });
            scopeHTML += '</ul>';
            
            container.innerHTML = scopeHTML;
        }
        
        // Helper function to populate acceptance criteria
        function populateAcceptanceCriteria(data) {
            const container = document.getElementById('acceptanceCriteria');
            if (!container) return;
            
            const acceptanceCriteria = data.acceptanceCriteria || [
                `Automated ${data.projectOverview?.processName?.toLowerCase() || 'process'} workflow processes instances successfully`,
                `System achieves target ${data.investmentSummary?.timeReduction || '80%'} time reduction in processing`,
                'All specified system integrations function correctly and pass testing',
                'User training completed and staff can operate the system independently',
                'System monitoring and alerting mechanisms are operational',
                '99.5% uptime SLA requirements met during testing period'
            ];
            
            let criteriaHTML = '<p>The implementation is considered successful when:</p><ul>';
            acceptanceCriteria.forEach(criterion => {
                criteriaHTML += `<li>${criterion}</li>`;
            });
            criteriaHTML += '</ul>';
            
            container.innerHTML = criteriaHTML;
        }
        
        // Helper function to populate project assumptions
        function populateProjectAssumptions(data) {
            const container = document.getElementById('projectAssumptions');
            if (!container) return;
            
            const projectAssumptions = data.projectAssumptions || [
                'Client provides timely access to systems and stakeholders as required',
                'All infrastructure is hosted and managed by SAX Technology Advisors',
                'Current business processes and requirements remain stable during implementation',
                'Client staff are available for training and user acceptance testing',
                'Azure and automation platform costs are included in the managed service fee',
                'Integration APIs remain stable and accessible during implementation'
            ];
            
            let assumptionsHTML = '<ul>';
            projectAssumptions.forEach(assumption => {
                assumptionsHTML += `<li>${assumption}</li>`;
            });
            assumptionsHTML += '</ul>';
            
            container.innerHTML = assumptionsHTML;
        }
        
        // Helper function to populate managed services pricing breakdown
        function populateManagedServicesPricing(data) {
            const container = document.getElementById('managedServicesPricingBreakdown');
            if (!container) return;
            
            const monthlyFee = data.commercials?.monthlyServiceFee?.replace(/[$,]/g, '') || '2100';
            const monthlyTotal = parseInt(monthlyFee);
            
            let pricingHTML = `
                <div style="text-align: center; margin: 20px 0;">
                    <div style="font-size: 32px; font-weight: bold; color: #3498db; margin-bottom: 10px;">
                        $${monthlyTotal.toLocaleString()}/month
                    </div>
                    <div style="font-size: 16px; color: #666;">Complete Managed Service</div>
                </div>
                
                <h4>Services Included:</h4>
                <ul>
                    <li><strong>System Monitoring & Maintenance</strong></li>
                    <li><strong>Monthly Performance Optimization</strong></li>
                    <li><strong>Technical Support</strong> during business hours</li>
                    <li><strong>Infrastructure & Hosting</strong></li>
                    <li><strong>AI Processing & Platform Costs</strong></li>
                    <li><strong>24/7 System Monitoring</strong> with proactive alerts and incident response</li>
                    <li><strong>Platform Updates & Enhancements</strong> automatically deployed</li>
                    <li><strong>Quarterly Business Reviews</strong> with stakeholder reporting</li>
                    <li><strong>99.5% Uptime SLA</strong> with redundancy and failover capabilities</li>
                </ul>
            `;
            
            container.innerHTML = pricingHTML;
        }
        
        // Make function available globally
        window.populatePDFData = populatePDFData;
        
        // Function to check for PDF data with retries
        function checkForPDFData() {
            console.log('Checking for PDF data...');
            
            // Check URL parameters first
            const urlParams = new URLSearchParams(window.location.search);
            const dataParam = urlParams.get('data');
            if (dataParam) {
                try {
                    const data = JSON.parse(decodeURIComponent(dataParam));
                    console.log('Found PDF data in URL parameters:', data);
                    populatePDFData(data);
                    return true;
                } catch (e) {
                    console.error('Error parsing URL data:', e);
                }
            }
            
            // Check if useSession flag is set (data is in sessionStorage)
            const useSession = urlParams.get('useSession');
            if (useSession === 'true') {
                console.log('useSession flag detected, checking sessionStorage...');
                try {
                    const sessionData = sessionStorage.getItem('pdfTemplateData');
                    if (sessionData) {
                        const data = JSON.parse(sessionData);
                        console.log('Found PDF data in sessionStorage:', data);
                        populatePDFData(data);
                        // Clear sessionStorage after use
                        sessionStorage.removeItem('pdfTemplateData');
                        return true;
                    } else {
                        console.log('No data found in sessionStorage');
                    }
                } catch (e) {
                    console.error('Error reading from sessionStorage:', e);
                }
            }
            
            // Try to get data from the opener window (parent window)
            if (window.opener) {
                console.log('Parent window detected');
                
                try {
                    // Check if the parent window has stored PDF data for us
                    if (window.opener.pdfDataForTemplate) {
                        console.log('Found PDF data from parent window:', window.opener.pdfDataForTemplate);
                        populatePDFData(window.opener.pdfDataForTemplate);
                        
                        // Clear the data after using it
                        window.opener.pdfDataForTemplate = null;
                        return true;
                    } else {
                        console.log('No PDF data found in parent window yet');
                    }
                } catch (e) {
                    console.error('Error accessing parent window:', e);
                }
            } else {
                console.log('No parent window detected - this may be a direct load');
            }
            
            return false;
        }
        
        // Check for data when the page loads
        window.addEventListener('DOMContentLoaded', function() {
            console.log('PDF Template loaded, initializing data check...');
            
            let dataLoaded = false;
            let attempts = 0;
            const maxAttempts = 20; // Try for up to 10 seconds
            
            // Try immediately
            dataLoaded = checkForPDFData();
            
            // If not loaded, set up polling with exponential backoff
            if (!dataLoaded) {
                const checkInterval = setInterval(function() {
                    attempts++;
                    console.log(`Attempt ${attempts} to load PDF data...`);
                    
                    dataLoaded = checkForPDFData();
                    
                    if (dataLoaded || attempts >= maxAttempts) {
                        clearInterval(checkInterval);
                        if (!dataLoaded) {
                            console.warn('Could not load PDF data after ' + maxAttempts + ' attempts');
                            // Show default/sample data message
                            document.body.insertAdjacentHTML('afterbegin', 
                                '<div style="background: #fff3cd; color: #856404; padding: 10px; text-align: center; border-bottom: 2px solid #ffc107;">' +
                                'Note: This PDF is showing default data. Generate from the ROI calculator for actual values.' +
                                '</div>'
                            );
                        }
                    }
                }, 500); // Check every 500ms
            }
            
            // Also listen for postMessage in case the parent sends data that way
            window.addEventListener('message', function(event) {
                console.log('Received message:', event);
                
                // Only accept messages from the same origin for security
                if (event.origin === window.location.origin || event.origin === window.location.protocol + '//' + window.location.host) {
                    if (event.data && event.data.type === 'pdfData') {
                        console.log('Received PDF data via postMessage:', event.data.data);
                        populatePDFData(event.data.data);
                        dataLoaded = true;
                    }
                }
            });
        });
        
        // Also check immediately in case DOMContentLoaded already fired
        if (document.readyState === 'interactive' || document.readyState === 'complete') {
            // Trigger check if DOM is already ready
            setTimeout(checkForPDFData, 100);
        }
    </script>
</body>
</html>
